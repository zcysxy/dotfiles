var gt=Object.create;var D=Object.defineProperty;var yt=Object.getOwnPropertyDescriptor;var St=Object.getOwnPropertyNames;var Pt=Object.getPrototypeOf,xt=Object.prototype.hasOwnProperty;var U=t=>D(t,"__esModule",{value:!0});var bt=(t,e)=>{for(var o in e)D(t,o,{get:e[o],enumerable:!0})},z=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of St(e))!xt.call(t,i)&&(o||i!=="default")&&D(t,i,{get:()=>e[i],enumerable:!(n=yt(e,i))||n.enumerable});return t},y=(t,e)=>z(U(D(t!=null?gt(Pt(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),At=(t=>(e,o)=>t&&t.get(e)||(o=z(U({}),e,1),t&&t.set(e,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var Lt={};bt(Lt,{default:()=>Nt});var $=require("@raycast/api");var p=require("@raycast/api"),V=y(require("fs")),J=y(require("path")),X=require("fs/promises"),W=require("os"),C=require("react");var s=require("@raycast/api"),S=y(require("fs"));async function Q(t){let e=F(t);e.vault.pinnedNotes=[];let o=e.data.findIndex(i=>i.vaultPath==t.path);e.data[o]=e.vault;let n={title:"Reset Pinned Notes",message:'Are you sure you want to reset all pinned notes for: "'+t.name+'"?',icon:s.Icon.ExclamationMark};if(await(0,s.confirmAlert)(n))return S.default.writeFileSync(s.environment.supportPath+"/data.json",JSON.stringify(e.data)),(0,s.showToast)(s.Toast.Style.Success,"Reset Pinned Notes for "+t.name),!0}function F(t){S.default.existsSync(s.environment.supportPath+"/data.json")||S.default.writeFileSync(s.environment.supportPath+"/data.json","[]");let e=S.default.readFileSync(s.environment.supportPath+"/data.json","utf8"),o=JSON.parse(e),n=o.filter(i=>i.vaultPath==t.path);if(n.length==0){let i={vaultPath:t.path,pinnedNotes:[]};return o.push(i),S.default.writeFileSync(s.environment.supportPath+"/data.json",JSON.stringify(o)),{vault:i,pinnedNotes:i.pinnedNotes,data:o}}else return{vault:n[0],pinnedNotes:n[0].pinnedNotes,data:o}}function G(t){let e=F(t);return e.pinnedNotes.forEach(o=>{(o.content==null||o.content=="")&&(o.content=P(o.path),w(o,t),_(o,t))}),e.pinnedNotes}function w(t,e){let o=F(e),n=o.pinnedNotes.filter(r=>r.path!==t.path);o.vault.pinnedNotes=n;let i=o.data.findIndex(r=>r.vaultPath==e.path);return o.data[i]=o.vault,S.default.writeFileSync(s.environment.supportPath+"/data.json",JSON.stringify(o.data)),(0,s.showToast)({title:"Note Unpinned",message:"'"+t.title+"' unpinned successfully.",style:s.Toast.Style.Success}),n}function g(t,e){return F(e).pinnedNotes.filter(n=>n.path==t.path).length!==0}function _(t,e){let o=F(e);if(g(t,e)){(0,s.showToast)({title:"Already Pinned",message:"'"+t.title+"' is already pinned.",style:s.Toast.Style.Failure});return}o.vault.pinnedNotes.push(t);let n=o.data.findIndex(i=>i.vaultPath==e.path);o.data[n]=o.vault,S.default.writeFileSync(s.environment.supportPath+"/data.json",JSON.stringify(o.data)),(0,s.showToast)({title:"Note Pinned",message:"'"+t.title+"' pinned successfully.",style:s.Toast.Style.Success})}function Ct(t){let e=(0,p.getPreferenceValues)();if(e.removeYAML){let o=t.match(/---(.|\n)*?---/gm);o&&(t=t.replace(o[0],""))}if(e.removeLatex){let o=t.matchAll(/\$\$(.|\n)*?\$\$/gm);for(let i of o)t=t.replace(i[0],"");let n=t.matchAll(/\$(.|\n)*?\$/gm);for(let i of n)t=t.replace(i[0],"")}return e.removeLinks&&(t=t.replaceAll("![[",""),t=t.replaceAll("[[",""),t=t.replaceAll("]]","")),t}function P(t,e=!0){let o="";try{o=V.default.readFileSync(t,"utf8")}catch{o="Couldn't read file. Did you move, delete or rename the file?"}return e&&(o=Ct(o)),o}function q(t){let e=t.split(J.default.sep).filter(o=>{if(o!="")return o}).pop();return e||"Default Vault Name (check your path preferences)"}function K(){return(0,p.getPreferenceValues)().vaultPath.split(",").filter(o=>o.trim()!=="").map(o=>({name:q(o.trim()),key:o.trim(),path:o.trim()}))}async function vt(){let t=J.default.resolve(`${(0,W.homedir)()}/Library/Application Support/obsidian/obsidian.json`);try{let e=JSON.parse(await(0,X.readFile)(t,"utf8"));return Object.values(e.vaults).map(({path:o})=>({name:q(o),key:o,path:o}))}catch{return[]}}function H(){let t=(0,C.useMemo)(()=>(0,p.getPreferenceValues)(),[]),[e,o]=(0,C.useState)(t.vaultPath?{ready:!0,vaults:K()}:{ready:!1,vaults:[]});return(0,C.useEffect)(()=>{e.ready||vt().then(n=>{o({vaults:n,ready:!0})}).catch(()=>o({vaults:K(),ready:!0}))},[]),e}async function Z(t,e){let o={title:"Delete Note",message:'Are you sure you want to delete the note: "'+t.title+'"?',icon:p.Icon.ExclamationMark};if(await(0,p.confirmAlert)(o))try{return V.default.unlinkSync(t.path),g(t,e)&&w(t,e),(0,p.showToast)({title:"Deleted Note",style:p.Toast.Style.Success}),!0}catch{return!1}else return!1}function tt(t,e,o){return e.length===0?t:t.filter(n=>o?n.title.toLowerCase().includes(e.toLowerCase())||n.content.toLowerCase().includes(e.toLowerCase()):n.title.toLowerCase().includes(e.toLowerCase())).sort((n,i)=>{let r=n.title,l=i.title;return r>l?1:r<l?-1:0})}function Y(t){return t.split(" ").length}function et(t){return Math.ceil(Y(t)/200)}function ot(t){let{birthtime:e}=V.default.statSync(t.path);return e}function nt(t){let{size:e}=V.default.statSync(t.path);return e/1024}function it(t,e){return t.length>e?"..."+t.slice(t.length-e).slice(1):t.slice(1)}async function Tt(){let t=await p.Clipboard.readText();return t||""}var Ft={0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"},wt={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"};async function E(t){let e=new Date,o=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),i=e.getSeconds().toString().padStart(2,"0"),r=Date.now().toString();t=t.replaceAll("{time}",e.toLocaleTimeString()),t=t.replaceAll("{date}",e.toLocaleDateString()),t=t.replaceAll("{year}",e.getFullYear().toString()),t=t.replaceAll("{month}",wt[e.getMonth()]),t=t.replaceAll("{day}",Ft[e.getDay()]),t=t.replaceAll("{hour}",o),t=t.replaceAll("{minute}",n),t=t.replaceAll("{second}",i),t=t.replaceAll("{millisecond}",e.getMilliseconds().toString()),t=t.replaceAll("{timestamp}",r),t=t.replaceAll("{zettelkastenID}",r);let l=await Tt();return t=t.replaceAll("{clipboard}",l),t}var b=require("@raycast/api");function at(t){let e=t.vaults;return _jsx(b.List,null,e?.map(o=>_jsx(b.List.Item,{title:o.name,key:o.key,actions:_jsx(b.ActionPanel,null,_jsx(b.Action.Push,{title:"Select Vault",target:t.target(o)}))})))}var x=require("@raycast/api"),k=require("react");var u=require("@raycast/api"),T=y(require("react"));var a=require("@raycast/api"),pt=y(require("fs")),A=y(require("react"));var d=require("@raycast/api"),rt=y(require("fs"));function st(t){let e=t.note,{pop:o}=(0,d.useNavigation)();async function n(i){let r=await E(i.content);rt.default.appendFileSync(e.path,`
`+r),(0,d.showToast)({title:"Added text to note",style:d.Toast.Style.Success}),o(),t.actionCallback(3)}return _jsx(d.Form,{navigationTitle:"Add text to: "+e.title,actions:_jsx(d.ActionPanel,null,_jsx(d.Action.SubmitForm,{title:"Submit",onSubmit:n}))},_jsx(d.Form.TextArea,{title:`Add text to:
`+e.title,id:"content",placeholder:"Text"}))}var c=require("@raycast/api"),lt=y(require("fs"));function ct(t){let e=t.note,{pop:o}=(0,c.useNavigation)();async function n(i){let r=i.content;r=await E(r);let l={title:"Override note",message:'Are you sure you want to override the note: "'+e.title+'"?',icon:c.Icon.ExclamationMark};await(0,c.confirmAlert)(l)&&(lt.default.writeFileSync(e.path,r),(0,c.showToast)({title:"Edited note",style:c.Toast.Style.Success}),t.actionCallback(1),o())}return _jsx(c.Form,{navigationTitle:"Edit: "+e.title,actions:_jsx(c.ActionPanel,null,_jsx(c.Action.SubmitForm,{title:"Submit",onSubmit:n}))},_jsx(c.Form.TextArea,{title:`Edit:
`+e.title,id:"content",placeholder:"Text",defaultValue:P(e.path,!1)}))}var v=require("@raycast/api"),B=require("react");function ut(t){let e=t.note,o=t.vault,{pop:n}=(0,v.useNavigation)(),[i,r]=(0,B.useState)(g(e,o)),[l,f]=(0,B.useState)(e.content);function h(){let m=P(e.path);e.content=m,f(m)}function N(m,R=void 0){switch(t.actionCallback(m),+m){case 0:r(!i);break;case 2:n();break;case 1:h();break;case 3:h()}}return _jsx(v.Detail,{navigationTitle:i?"\u2B50 "+e.title:e.title,markdown:l,actions:_jsx(v.ActionPanel,null,_jsx(O,{note:e,vault:o,actionCallback:N}),_jsx(I,{note:e,vault:o,actionCallback:N}))})}async function Vt(t){let o=(0,a.getPreferenceValues)().appendPrefix;o===void 0&&(o="");try{let n=await(0,a.getSelectedText)();n.trim()==""?(0,a.showToast)({title:"No text selected",message:"Make sure to select some text.",style:a.Toast.Style.Failure}):(pt.default.appendFileSync(t.path,`
`+o+n),(0,a.showToast)({title:"Added selected text to note",style:a.Toast.Style.Success}))}catch{(0,a.showToast)({title:"Couldn't copy selected text",message:"Maybe you didn't select anything.",style:a.Toast.Style.Failure})}}function I(t){let e=t.note,o=t.vault,n=encodeURIComponent(e.path),i=t.actionCallback,[r,l]=(0,A.useState)(g(e,o));return _jsx(A.default.Fragment,null,_jsx(a.Action.ShowInFinder,{title:"Show in Finder",icon:a.Icon.Finder,path:e.path,shortcut:{modifiers:["opt"],key:"enter"}}),_jsx(a.Action.Push,{title:"Edit Note",target:_jsx(ct,{note:e,actionCallback:i}),shortcut:{modifiers:["opt"],key:"e"},icon:a.Icon.Pencil}),_jsx(a.Action.Push,{title:"Append to Note",target:_jsx(st,{note:e,actionCallback:i}),shortcut:{modifiers:["opt"],key:"a"},icon:a.Icon.Pencil}),_jsx(a.Action,{title:"Append Selected Text to Note",shortcut:{modifiers:["opt"],key:"s"},onAction:()=>{Vt(e)},icon:a.Icon.Pencil}),_jsx(a.Action.CopyToClipboard,{title:"Copy Note Content",content:e.content,shortcut:{modifiers:["opt"],key:"c"}}),_jsx(a.Action.Paste,{title:"Paste Note Content",content:e.content,shortcut:{modifiers:["opt"],key:"v"}}),_jsx(a.Action.CopyToClipboard,{title:"Copy Markdown Link",icon:a.Icon.Link,content:`[${e.title}](obsidian://open?path=${n})`,shortcut:{modifiers:["opt"],key:"l"}}),_jsx(a.Action.CopyToClipboard,{title:"Copy Obsidian URI",icon:a.Icon.Link,content:`obsidian://open?path=${n}`,shortcut:{modifiers:["opt"],key:"u"}}),_jsx(a.Action,{title:r?"Unpin Note":"Pin Note",shortcut:{modifiers:["opt"],key:"p"},onAction:()=>{r?(w(e,o),l(!r),i(0)):(_(e,o),l(!r),i(0))},icon:r?a.Icon.XmarkCircle:a.Icon.Pin}),_jsx(a.Action,{title:"Delete Note",shortcut:{modifiers:["opt"],key:"d"},onAction:()=>{Z(e,o).then(h=>{h&&i(2)})},icon:{source:a.Icon.Trash,tintColor:a.Color.Red}}))}function O(t){let e=t.note,o=t.vault,i=(0,a.getPreferenceValues)().primaryAction,r=_jsx(a.Action.Push,{title:"Quick Look",target:_jsx(ut,{note:e,vault:o,actionCallback:t.actionCallback}),icon:a.Icon.Eye}),l=_jsx(a.Action.Open,{title:"Open in Obsidian",target:"obsidian://open?path="+encodeURIComponent(e.path),icon:a.Icon.TextDocument});return i=="quicklook"?_jsx(A.default.Fragment,null,r,l):i=="obsidian"?_jsx(A.default.Fragment,null,l,r):_jsx(A.default.Fragment,null,r,l)}function Dt(t){let e=t.note,o=t.vault,[n,i]=(0,T.useState)(e.content),[r,l]=(0,T.useState)(g(e,o));function f(){let N=P(e.path);e.content=N,i(N)}function h(N){switch(+N){case 0:l(!r);break;case 2:t.onDelete(e);break;case 1:f();break;case 3:f()}}return _jsx(u.List.Item,{title:e.title,accessories:[{text:r?"\u2B50\uFE0F":""}],detail:_jsx(u.List.Item.Detail,{markdown:n,metadata:t.pref.showMetadata?_jsx(u.List.Item.Detail.Metadata,null,_jsx(u.List.Item.Detail.Metadata.Label,{title:"Character Count",text:n.length.toString()}),_jsx(u.List.Item.Detail.Metadata.Label,{title:"Word Count",text:Y(n).toString()}),_jsx(u.List.Item.Detail.Metadata.Label,{title:"Reading Time",text:et(n).toString()+" min read"}),_jsx(u.List.Item.Detail.Metadata.Separator,null),_jsx(u.List.Item.Detail.Metadata.Label,{title:"Creation Date",text:ot(e).toLocaleDateString()}),_jsx(u.List.Item.Detail.Metadata.Label,{title:"File Size",text:nt(e).toFixed(2)+" KB"}),_jsx(u.List.Item.Detail.Metadata.Label,{title:"Note Path",text:it(e.path.split(o.path)[1],55)})):_jsx(T.default.Fragment,null)}),actions:_jsx(u.ActionPanel,null,_jsx(T.default.Fragment,null,_jsx(O,{note:e,vault:o,actionCallback:h}),_jsx(I,{note:e,vault:o,actionCallback:h}),t.action&&t.action(e)))})}function dt(t){let e=t.notes,o=t.vault,n=(0,u.getPreferenceValues)(),i=e===void 0;return e!==void 0&&(i=e.length==0),t.isLoading!==void 0&&(i=t.isLoading),_jsx(u.List,{isLoading:i,isShowingDetail:n.showDetail,onSearchTextChange:t.onSearchChange},e?.map(r=>_jsx(Dt,{note:r,vault:o,key:r.key,pref:n,onDelete:t.onDelete,action:t.action})))}function j(t){let e=(0,x.getPreferenceValues)(),[o,n]=(0,k.useState)([]),[i,r]=(0,k.useState)(""),l=(0,k.useMemo)(()=>tt(o,i,e.searchContent),[o,i]),f=t.vault;function h(m){n(o.filter(R=>R.path!==m.path))}function N(m){return _jsx(x.Action,{title:"Reset Pinned Notes",icon:{source:x.Icon.XmarkCircle,tintColor:x.Color.Red},shortcut:{modifiers:["opt"],key:"r"},onAction:async()=>{await Q(f)&&n(R=>[])}})}return(0,k.useEffect)(()=>{let m=G(f);n(m)},[]),_jsx(dt,{notes:l.slice(0,1e3),isLoading:o===void 0,vault:f,action:N,onSearchChange:r,onDelete:h})}var mt=require("@raycast/api");function ft(){return _jsx(mt.Detail,{markdown:`# No vaults found

 Please use Obsidian to create a vault, or set a vault path in the extension's preferences before using this command.`})}var M=require("@raycast/api");function ht(){(0,M.showToast)({title:"Path Error",message:"Something went wrong with your vault path. There are no paths to select from.",style:M.Toast.Style.Failure})}function Nt(){let{vaults:t,ready:e}=H();return e?t.length===0?_jsx(ft,null):t.length>1?_jsx(at,{vaults:t,target:o=>_jsx(j,{vault:o})}):t.length==1?_jsx(j,{vault:t[0]}):(ht(),_jsx($.List,null)):_jsx($.List,{isLoading:!0})}module.exports=At(Lt);0&&(module.exports={});
